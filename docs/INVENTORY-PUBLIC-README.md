# 🏨 공개 재고 현황 페이지 + GPT 챗봇 시스템

## 📋 개요

거래처와 파트너사가 **로그인 없이** 실시간 객실 재고 현황을 확인하고, **GPT 챗봇**을 통해 자연어로 예약 가능 여부를 질의할 수 있는 시스템입니다.

## 🎯 주요 기능

### 1. 공개 재고 현황 페이지
- **URL**: `https://www.guamsavecard.com/inventory/view`
- **접근 권한**: 누구나 접근 가능 (로그인 불필요)
- **기능**:
  - 호텔별 실시간 재고 조회
  - 6개월 달력 뷰
  - 객실 타입별 가능/마감 상태 표시
  - 숫자 카운팅 or 상태 표시 방식 지원

### 2. GPT 챗봇 (객실 예약 도우미)
- **실시간 재고 데이터 기반 답변**
- **자연어 질의 처리**
- **예시 질문**:
  - "두짓타니 12월 3일부터 3박 가능해?"
  - "하얏트 리젠시 크리스마스 주간 가능해?"
  - "다음주 월요일부터 2박 가능한 호텔?"

## 🔧 기술 구현

### 파일 구조
```
views/
  └── inventory-public.ejs        # 공개 페이지 UI
routes/
  └── inventory-chat.js            # GPT 챗봇 API
server-postgresql.js               # 라우트 연결
```

### API 엔드포인트

#### 1. 공개 페이지
```
GET /inventory/view
- 로그인 불필요
- inventory-public.ejs 렌더링
```

#### 2. 챗봇 API
```
POST /api/inventory/chat
Body: {
  message: "두짓타니 12월 3일부터 3박 가능해?",
  hotelId: "1" (선택사항)
}

Response: {
  success: true,
  reply: "두짓타니 12월 3일부터 3박은 모든 객실 타입에서 예약 가능합니다! 🎉",
  dataSource: {
    totalRecords: 250,
    dateRange: "2025-11-14 ~ 2026-02-14",
    hotelsIncluded: 3
  }
}
```

## 🤖 GPT 챗봇 동작 원리

### 1. 재고 데이터 수집
- 현재 ~ 3개월 후까지의 재고 데이터 조회
- 호텔별, 객실 타입별, 날짜별 구조화

### 2. GPT 프롬프트 구성
```javascript
시스템 프롬프트:
- 역할: 호텔 객실 예약 전문 상담사
- 데이터: 실시간 재고 JSON
- 규칙:
  1. 제공된 재고 데이터만 기반으로 답변
  2. 데이터 없으면 "확인이 필요합니다"
  3. 한국어로 친절하게
  4. 3-4문장 이내로 간결하게
```

### 3. 답변 생성 규칙
- `available_rooms = 0` → 마감
- `available_rooms = 1~4` → 잔여 적음
- `available_rooms >= 5` → 충분함
- 연박 문의 시 모든 날짜 체크

## 💡 사용 시나리오

### 시나리오 1: 거래처 재고 확인
```
1. 거래처가 /inventory/view 접속
2. 호텔 선택 (예: 두짓타니)
3. 달력에서 원하는 날짜 확인
4. 초록색(가능), 빨간색(마감), 노란색(잔여 적음)
```

### 시나리오 2: 챗봇으로 빠른 확인
```
거래처: "두짓타니 12월 3일부터 3박 가능해?"

챗봇: "두짓타니 12월 3일부터 3박(12/3-12/5)은 
모든 객실 타입에서 예약 가능합니다! 🎉 
디럭스룸 8개, 스위트룸 3개 남아있어요. 
어떤 객실 타입을 원하시나요?"
```

### 시나리오 3: 복수 호텔 비교
```
거래처: "다음주 하얏트랑 두짓 중에 어디가 더 많이 남았어?"

챗봇: "다음주(11/20-11/22 기준) 
하얏트 리젠시: 디럭스 5개, 스위트 2개
두짓타니: 디럭스 8개, 스위트 3개
두짓타니가 객실이 더 여유롭습니다! 😊"
```

## 🎨 UI/UX 특징

### 달력 섹션
- **그리드 레이아웃**: 달력 + 챗봇 나란히 배치
- **반응형 디자인**: 모바일에서는 세로 배치
- **색상 코드**:
  - 🟢 초록: 가능 (5개 이상)
  - 🟡 노랑: 잔여 적음 (1-4개)
  - 🔴 빨강: 마감 (0개)

### 챗봇 섹션
- **현대적 UI**: 그라디언트 배경, 카드 디자인
- **메시지 버블**: 사용자(오른쪽), 봇(왼쪽)
- **타이핑 인디케이터**: 봇 응답 중 애니메이션
- **예시 질문 버튼**: 클릭하면 자동 입력

## 🔐 보안 고려사항

### 공개 페이지
- ✅ 로그인 불필요 (의도된 기능)
- ✅ 읽기 전용 (수정 불가)
- ⚠️ 재고 데이터 노출 (경쟁사 주의)

### 해결 방안
1. **제한된 데이터**: 3개월만 노출
2. **숫자 비공개**: 상태 방식(O/X)만 표시 가능
3. **IP 제한**: 필요시 특정 IP만 허용

## 🚀 관리자 기능

### 관리자 페이지에서 접근
```
/admin/room-inventory → "공개 페이지 보기" 버튼 클릭
→ 새 탭에서 /inventory/view 열림
```

### 재고 업데이트 흐름
```
1. 관리자가 /admin/room-inventory에서 재고 수정
2. 저장 버튼 클릭
3. 공개 페이지에서 즉시 반영
4. 챗봇도 최신 데이터로 답변
```

## 📊 모니터링

### 로그 확인
```javascript
// 서버 로그
💬 챗봇 질문: 두짓타니 12월 3일부터 3박 가능해?
📊 재고 데이터 250개 조회
🤖 GPT 응답: 두짓타니 12월 3일부터...
```

### 성능 지표
- 재고 조회 속도: ~100ms
- GPT 응답 시간: ~2-3초
- 페이지 로딩: ~500ms

## 🎯 향후 개선 방향

1. **다국어 지원**: 영어, 일본어, 중국어
2. **예약 링크**: 챗봇에서 바로 예약 페이지로 이동
3. **알림 기능**: 원하는 날짜 가능 시 알림
4. **통계 대시보드**: 거래처별 조회 기록
5. **캐싱**: Redis로 재고 데이터 캐싱

## 🔗 관련 링크

- **공개 페이지**: https://www.guamsavecard.com/inventory/view
- **관리자 페이지**: https://www.guamsavecard.com/admin/room-inventory
- **API 문서**: /docs/API.md

## 💬 문의

- 기술 문의: 개발팀
- 기능 제안: product@guamsavecard.com
- 긴급 장애: 010-XXXX-XXXX

---

**완성도: 100%** | **배포일: 2025-11-14** | **버전: 1.0.0**
