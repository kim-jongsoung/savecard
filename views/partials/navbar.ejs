<%
// í˜„ì¬ í˜ì´ì§€ê°€ ì†í•œ ERP ì˜ì—­ íŒë‹¨
const savecardPages = ['savecard-dashboard', 'users', 'agencies', 'stores', 'usages', 'issue-codes'];
const activityPages = ['dashboard', 'inbox', 'reservations', 'assignments', 'settlements', 'pricing', 'rag-manager', 'settings', 'pickup'];
const hotelPages = ['hotel-inbox', 'hotel-assignments', 'hotel-settlements', 'hotels', 'room-types', 'room-inventory', 'season-calendar', 'season-rates', 'promotions', 'booking-agencies', 'agency-fees'];

let currentErp = 'activity'; // ê¸°ë³¸ê°’: ì¦ê¸¸ê±°ë¦¬
if (savecardPages.includes(currentPage)) currentErp = 'savecard';
else if (hotelPages.includes(currentPage)) currentErp = 'hotel';
%>

<!-- ë„¤ë¹„ê²Œì´ì…˜ - 2ë‹¨ íƒ­ êµ¬ì¡° -->
<nav class="navbar navbar-expand-lg navbar-light border-bottom" style="background-color: #ffffff !important;">
    <div class="nav-container-fixed">
        <div class="d-flex flex-column w-100">
            <!-- 1ë‹¨: ë¡œê³  + ERP íƒ­ + ì‚¬ìš©ì + ë¡œê·¸ì•„ì›ƒ -->
            <div class="d-flex align-items-center" style="padding: 0.4rem 0; border-bottom: 2px solid #e9ecef;">
                <!-- ë¡œê³  -->
                <a href="/admin/dashboard" style="margin-right: 1.5rem;">
                    <img src="https://media.eoding.com/media/travelagent/1423/logo/rainbow_golf_club_horizontal_180px_whitebg_95jeIil.png" alt="Logo" style="height: 28px;">
                </a>
                
                <!-- ERP íƒ­ -->
                <div class="erp-tabs">
                    <a href="/admin/savecard-dashboard" class="erp-tab <%= currentErp === 'savecard' ? 'active' : '' %>" style="background: #b3e5fc; color: #01579b;">ê´Œì„¸ì´ë¸Œì¹´ë“œ ERP</a>
                    <a href="/admin/dashboard" class="erp-tab <%= currentErp === 'activity' ? 'active' : '' %>" style="background: #c8e6c9; color: #2e7d32;">ì¦ê¸¸ê±°ë¦¬ ERP</a>
                    <a href="/admin/hotel-inbox" class="erp-tab <%= currentErp === 'hotel' ? 'active' : '' %>" style="background: #ffe0b2; color: #e65100;">í˜¸í…”ì˜ˆì•½ ERP</a>
                </div>
                
                <!-- ì‚¬ìš©ì + ë¡œê·¸ì•„ì›ƒ -->
                <div style="margin-left: auto; display: flex; align-items: center; gap: 0.5rem;">
                    <span style="font-size: 0.7rem; color: #495057;"><%= adminUsername %></span>
                    <a href="/admin/logout" style="font-size: 0.7rem; color: #dc3545; text-decoration: none;">ë¡œê·¸ì•„ì›ƒ</a>
                </div>
            </div>
            
            <!-- 2ë‹¨: í˜„ì¬ ERP ë©”ë‰´ë§Œ í‘œì‹œ -->
            <% if (currentErp === 'savecard') { %>
            <div class="d-flex align-items-center" style="padding: 0.3rem 0;">
                <ul class="navbar-nav flex-row">
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'savecard-dashboard' ? 'active' : '' %>" href="/admin/savecard-dashboard">ëŒ€ì‹œë³´ë“œ</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'users' ? 'active' : '' %>" href="/admin/users">ì‚¬ìš©ì</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'agencies' ? 'active' : '' %>" href="/admin/agencies">ì—¬í–‰ì‚¬</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'stores' ? 'active' : '' %>" href="/admin/stores">ì œíœ´ì—…ì²´</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'usages' ? 'active' : '' %>" href="/admin/usages">ì‚¬ìš©ë‚´ì—­</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'issue-codes' ? 'active' : '' %>" href="/admin/issue-codes">ë°œê¸‰ì½”ë“œ</a></li>
                </ul>
            </div>
            <% } else if (currentErp === 'activity') { %>
            <div class="d-flex align-items-center" style="padding: 0.3rem 0;">
                <ul class="navbar-nav flex-row">
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'dashboard' ? 'active' : '' %>" href="/admin/dashboard">ëŒ€ì‹œë³´ë“œ</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'inbox' ? 'active' : '' %>" href="/admin/inbox">ì¸ë°•ìŠ¤</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'reservations' ? 'active' : '' %>" href="/admin/reservations">ì˜ˆì•½ê´€ë¦¬</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'assignments' ? 'active' : '' %>" href="/admin/assignments">ìˆ˜ë°°ê´€ë¦¬</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'settlements' ? 'active' : '' %>" href="/admin/settlements">ì •ì‚°ê´€ë¦¬</a></li>
                    <li class="nav-item"><span class="nav-divider">|</span></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'pricing' ? 'active' : '' %>" href="/admin/pricing">ìš”ê¸ˆRAG</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'rag-manager' ? 'active' : '' %>" href="/admin/rag-manager">ë°”ìš°ì²˜RAG</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'settings' ? 'active' : '' %>" href="/admin/settings">ì„¤ì •</a></li>
                    <li class="nav-item"><span class="nav-divider">|</span></li>
                    <li class="nav-item"><a class="nav-link nav-link-pickup <%= currentPage === 'pickup' ? 'active' : '' %>" href="/pickup">ê³µí•­í”½ì—…</a></li>
                </ul>
            </div>
            <% } else if (currentErp === 'hotel') { %>
            <div class="d-flex align-items-center" style="padding: 0.3rem 0;">
                <ul class="navbar-nav flex-row">
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'hotel-inbox' ? 'active' : '' %>" href="/admin/hotel-inbox">ì¸ë°•ìŠ¤</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'hotel-assignments' ? 'active' : '' %>" href="/admin/hotel-assignments">ìˆ˜ë°°ê´€ë¦¬</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'hotel-settlements' ? 'active' : '' %>" href="/admin/hotel-settlements">ì •ì‚°ê´€ë¦¬</a></li>
                    <li class="nav-item"><span class="nav-divider">|</span></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'hotels' ? 'active' : '' %>" href="/admin/hotels">í˜¸í…”ê´€ë¦¬</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'room-types' ? 'active' : '' %>" href="/admin/room-types">ê°ì‹¤íƒ€ì…</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'room-inventory' ? 'active' : '' %>" href="/admin/room-inventory">ì¬ê³ ê´€ë¦¬</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'season-calendar' ? 'active' : '' %>" href="/admin/season-calendar">ì‹œì¦Œë‹¬ë ¥</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'season-rates' ? 'active' : '' %>" href="/admin/season-rates">ì‹œì¦Œìš”ê¸ˆ</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'promotions' ? 'active' : '' %>" href="/admin/promotions">í”„ë¡œëª¨ì…˜</a></li>
                    <li class="nav-item"><span class="nav-divider">|</span></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'booking-agencies' ? 'active' : '' %>" href="/admin/booking-agencies">ê±°ë˜ì²˜</a></li>
                    <li class="nav-item"><a class="nav-link <%= currentPage === 'agency-fees' ? 'active' : '' %>" href="/admin/agency-fees">ìˆ˜ë°°í”¼</a></li>
                </ul>
            </div>
            <% } %>
        </div>
    </div>
</nav>

<style>
/* ğŸ”’ ì „ì—­ í°íŠ¸ í¬ê¸° ì œí•œ: ì»´íŒ©íŠ¸í•˜ê²Œ ì¶•ì†Œ */
body, p, span, div, td, th, label, input, select, textarea, button, a, li, ul, ol {
    font-size: 0.75rem !important;
}

h1, h2, h3, h4, h5, h6 {
    font-size: 0.85rem !important;
    font-weight: 600;
}

.modal-title {
    font-size: 0.85rem !important;
}

.table {
    font-size: 0.75rem !important;
}

.badge {
    font-size: 0.7rem !important;
}

small, .small {
    font-size: 0.7rem !important;
}

/* ë„¤ë¹„ê²Œì´ì…˜ - ì‹¬í”Œí•˜ê³  ì»´íŒ©íŠ¸í•œ PC ìµœì í™” ìŠ¤íƒ€ì¼ */
.navbar {
    padding: 0.3rem 0;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    background-color: #ffffff !important;
    width: 100%;
}

/* ë„¤ë¹„ê²Œì´ì…˜ ì»¨í…Œì´ë„ˆ 1300px ê³ ì • ë° ì¤‘ì•™ ì •ë ¬ */
.nav-container-fixed {
    width: 1300px !important;
    max-width: 1300px !important;
    margin-left: auto !important;
    margin-right: auto !important;
    padding: 0 !important;
    display: block !important;
}

.navbar-brand {
    font-size: 1.1rem;
    font-weight: 700;
    color: #2c3e50 !important;
    letter-spacing: -0.5px;
}

/* ERP íƒ­ ë²„íŠ¼ */
.erp-tabs {
    display: flex;
    gap: 0.5rem;
}

.erp-tab {
    font-size: 0.7rem;
    font-weight: 600;
    padding: 0.3rem 0.8rem;
    border-radius: 4px;
    text-decoration: none;
    transition: all 0.2s;
    opacity: 0.6;
}

.erp-tab:hover {
    opacity: 0.8;
    transform: translateY(-1px);
}

.erp-tab.active {
    opacity: 1;
    font-weight: 700;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* êµ¬ë¶„ì„  */
.nav-divider {
    color: #dee2e6;
    padding: 0 0.2rem;
    font-size: 0.9rem;
}

/* ë©”ë‰´ ë§í¬ - ì»´íŒ©íŠ¸í•˜ê³  í´ë¦­í•˜ê¸° ì‰½ê²Œ */
.navbar-nav .nav-link {
    color: #212529 !important;
    font-size: 0.54rem;
    font-weight: 400;
    padding: 0.2rem 0 !important;
    transition: all 0.15s;
    border-radius: 0;
    min-width: auto;
    text-align: center;
    white-space: nowrap;
    margin: 0 0.3rem;
}

.navbar-nav .nav-link:hover {
    color: #007bff !important;
    background-color: #f0f4ff;
    transform: translateY(-1px);
}

.navbar-nav .nav-link.active {
    color: #007bff !important;
    background-color: #e7f3ff;
    font-weight: 500;
    border-bottom: 2px solid #007bff;
}

/* ê³µí•­í”½ì—… ê°•ì¡° */
.nav-link-pickup {
    color: #28a745 !important;
    font-weight: 400;
}

.nav-link-pickup:hover {
    color: #218838 !important;
    background-color: #e8f5e9 !important;
}

.nav-link-pickup.active {
    color: #155724 !important;
    background-color: #d4edda !important;
}


/* ê°„ê²© ì¡°ì • - ìµœì†Œí™” */
.navbar-nav .nav-item {
    margin: 0;
}

/* ë¹„í™œì„±í™” ë§í¬ (ë¯¸êµ¬í˜„ ë©”ë‰´) */
.nav-link-disabled {
    color: #adb5bd !important;
    cursor: not-allowed;
    pointer-events: none;
    font-style: italic;
    min-width: auto;
    text-align: center;
    white-space: nowrap;
}

</style>
